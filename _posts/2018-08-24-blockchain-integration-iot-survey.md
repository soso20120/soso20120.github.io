---
layout: post
title: On blockchain and its integration with IoT. Challenges and opportunities
excerpt: 
tags:
- Blockchain
- IoT
- Survey

---


## 摘要

在物联网（IoT）愿景中，传统设备变得智能和自主。由于技术的进步，这一愿景正在变为现实，但仍有挑战需要解决，特别是在安全领域，例如数据可靠性。考虑到未来几年物联网的预测演变，有必要提供对这个巨大的传入信息来源的信心。区块链已成为一项关键技术，将改变我们共享信息的方式。在不需要权限的情况下建立对分布式环境的信任是一项技术进步，有可能改变许多行业，其中包括物联网。物联网已经利用大数据和云计算等颠覆性技术克服了自其构想以来的局限性，我们认为区块链将成为下一个改善物联网的技术。本文重点研究这种关系，研究区块链物联网应用中的挑战，并调查最相关的工作，以分析区块链如何可能改善物联网。

## 介绍

小型化，电子和无线通信技术的快速发展为我们的社会带来了前所未有的进步。 这导致许多领域的合适电子设备数量的增加，生产成本的降低以及从现实世界到数字世界的范式转变。 因此，我们通过现有技术更好地了解世界，改变了我们彼此之间以及与环境互动的方式。 物联网（IoT）已经成为从无线传感器网络（WSN）到射频识别（RFID）的一系列技术，提供通过互联网感知，启动和通信的功能。如今，物联网设备可以是从可穿戴设备到硬件开发平台的电子设备，并且可以使用它的应用范围涵盖社会的许多领域。 物联网在将当前城市转变为智能城市，将电网转变为智能电网以及将房屋转变为智能家居方面发挥着核心作用，而这仅仅是个开始。 根据各种研究报告，预计到2020年连接设备的数量将达到200亿至500亿[2]，主要是因为物联网可以在现场放置大量设备。

物联网可视化一个完全连通的世界，在这个世界中，事物能够传达测量数据并相互交互。 这使得现实世界的数字表示成为可能，通过该数字表示可以开发各种行业中的许多智能应用。这些包括：智能家居，可穿戴设备，智能城市，医疗保健，汽车，环境，智能水，智能电网等。 物联网解决方案正在许多领域得到部署，优化了生产和数字化行业。物联网应用具有非常特殊的特性，它们产生大量数据，需要长时间连接和供电。这与内存，计算机容量，网络的限制一起 而有限的电力供应带来了很多挑战。

物联网的巨大扩展必须得到标准机制和协议的支持，以减少现场的现有异质性。这种异质性导致垂直孤岛并减少物联网的采用。 但是，除了物联网中存在的异构性和集成挑战外，其数据的可信度也是一个需要牢记的重要问题。 如今，我们信任金融实体和政府等信息，但是我们能否确保他们和其他外部实体（如物联网公司）提供的信息没有以任何方式被篡改/篡改/伪造？ 在集中式架构中，这是一个难以回答的问题。 不信任的实体可以根据自己的兴趣改变信息，因此他们提供的信息可能不完全可靠。这就要求他们知道信息是否经过修改。

在IoT数据中提供可信赖性的一种方法是通过其所有参与者信任的分布式服务来保证数据保持不可变。 如果所有参与者都具有数据并且他们具有验证数据自第一定义以来未被篡改的手段，则可以实现可信赖性。 此外，拥有一个保证数据可靠性的系统将允许政府与公民共享和安全地传输信息。

在法规要求资产在其生命周期内进行详尽的可追溯性的许多领域，数据不变性成为关键挑战。具体而言，欧盟（EU）法规要求食品生产者除了确定每种原料的最终目的地外，还要追踪和识别所有用于制作其食品的原料。例如，对于拥有数千家制造供应商和数百万客户的大型食品公司而言，信息需要数字化并且其处理自动化以符合法规。可追溯性方面的强有力监管的一个例子是猪肉供应，在这种情况下，除了追踪猪饲料和处理中使用的原料以及猪肉的最终目的地之外，工厂之间的动物运输也必须依法登记。这些情景涉及许多参与者，其中一些仍然依赖于非自动化的信息处理方法。在食品污染的情况下，这是历史上世界人口健康的一个重要问题，丢失或难以找到的信息意味着延误在问题的焦点位置。这也可能导致公众对受污染产品的不信任以及他们的需求大幅减少。根据世界卫生组织（WHO）的数据，据估计，全世界每年约有6亿人因食用受污染的食物而患病，其中420,000人死于同一原因[3]。因此，缺少或无法访问的信息会影响粮食安全和客户健康。在这些情景中，物联网有可能改变和彻底改变行业和社会，将知识数字化，以便实时查询和控制。这项技术可用于改善城市，工业，健康和运输等许多领域的现有流程。

尽管物联网可以促进信息本身的数字化，但这种信息的可靠性仍然是一个关键挑战。从这个意义上说，作为第一个分散式加密货币诞生的新技术有可能为数据可靠性问题提供解决方案：比特币，它彻底改变了汇款机制。比特币加密货币及其即将推出的许多变种可以在没有金融实体和外汇交易的情况下全球转移，具有数字和不可转让的钱包。比特币由一个协议支持，该协议详细说明了负责确保信息随时间保持不变的基础设施。该协议称为块链。它已应用于许多其他领域，并且在超出应用程序的应用程序中保证信息不变性加密货币。区块链已经彻底改变了信息的可信度。例如，这种技术已被政府实体，租赁和数据存储等用于投票系统[4]。

在本文中，将分析物联网和区块链当前的挑战以及它们组合使用的潜在优势。

除了审查可用的区块链平台以应对这些挑战之外，还将突出强调该领域的破坏性应用。

该论文的主要贡献是：
1. 区块链技术调查，分析其独特的功能和开放的挑战。
2. 识别和分析集成物联网和区块链的不同方式。
3. 研究区块链和物联网整合的挑战，潜在利益和未决问题。
4. 研究现有的区块链 - 物联网平台和应用。
5. 评估和比较物联网设备中不同区块链的性能。

本文的其余部分安排如下。 第2节介绍了区块链技术并分析了其主要挑战。 在第3节中，解决了物联网和区块链集成，分析了这种集成所面临的挑战。 物联网和物联网 - 区块链应用的区块链平台的最新技术在第4节中介绍。最后，我们的结论和未来的工作将在第5节中介绍。

## 区块链

当没有提供验证或审计机制时，信任系统的信任问题极其复杂，特别是当他们必须处理敏感信息时，例如与虚拟货币的经济交易。 在这种背景下，Satoshi Nakamoto在2008年[5]提出了两个引起巨大反响的激进概念。 第一个是比特币，一种虚拟加密货币，在没有任何集中管理机构或金融实体支持的情况下维持其价值。 相反，硬币由分散的P2P网络集体和安全地保持，这些网络构成可审计和可验证的网络。第二个概念是区块链，其受欢迎程度甚至超过了加密货币本身。

区块链是允许一组不可靠的参与者验证交易的机制。 它提供分布式，不可变，透明，安全且可审计的分类帐。 区块链可以公开和完整地查阅，允许访问自系统第一次交易以来发生的所有交易，并且可以由任何实体随时进行验证和整理。 区块链协议构造一系列块中的信息，其中每个块存储在给定时间执行的一组比特币交易。 通过引用前一个块将块链接在一起，形成链。

为了支持和操作区块链，网络对等方必须提供以下功能：路由，存储，钱包服务和挖掘[6]。 根据它们提供的功能，不同类型的节点可以是网络的一部分。 表1总结了比特币网络中最常见的节点类型。

路由功能是参与P2P网络所必需的，这包括事务和块传播。 存储功能负责在节点中保留链的副本（完整节点的整个链，以及轻节点的一部分）。小型号服务提供允许用户订购交易的安全密钥，即操作 用他们的比特币。 最后，挖掘功能负责通过解决工作证明来创建新块。 执行工作证明（或采矿）的节点称为矿工，他们接收新生成的比特币和费用作为奖励。 工作证明的概念是在区块链网络中实现无信任共识的关键之一。 工作证明包括计算密集型任务，这是生成块所必需的。 这项工作必须很复杂才能解决，同时一旦完成就很容易核实。

一旦矿工完成工作证明，它就会在网络中发布新块，网络的其余部分会在将其添加到链中之前验证其有效性。由于块的生成是在网络中同时执行的，因此块链可能暂时分叉在不同的分支中（由不同的矿工生成）。通过考虑块的最长分支是将被视为有效的分支来解决这种差异。这与块生成过程的密集性一起提供了一种新颖的，分布式无信任的共识机制。恶意攻击者修改块并破坏块链的计算成本非常高，因为其他可信赖的矿工会在块生成过程中超过攻击者，因此块的可信分支将使攻击者生成的块无效。在技术方面，为了将操纵块成功地添加到链中，有必要比网络的其余部分更快地解决工作证明，这在计算上太昂贵 - 它需要至少控制51%的网络中计算资源。由于修改区块链所需的大量计算能力，其块的损坏实际上是不可能的。这意味着，即使参与者对比特币的使用并不完全诚实，只要网络的大部分由诚实的参与者组成，网络总能达到共识。中本聪提出的解决方案是分布系统中不可靠行为者可靠性的重大革命。有关区块链架构的更多细节可以在[5,7]中找到。

区块链还提供了一种技术，可以实现智能合约的概念。一般而言，智能合约是指允许在考虑一组预定义条件的情况下自动执行/实施合同的计算机协议或程序。例如，智能合约定义了每当交易发生在加密货币交换时将执行的应用程序逻辑。在智能合约中，功能和条件可以在加密货币交换之外定义，例如在与非货币要素的特定交易范围内验证资产，这使其成为将区块链技术扩展到其他领域的完美组成部分。以太坊[8]是包含智能合约的先驱区块链之一。如今，智能合约已被纳入大多数现有区块链实施中，例如Hyperledger [9]，这是一种区块链，专为允许根据用户需求（智能合约，服务或咨询等）部署组件的公司而设计。支持IBM，摩根大通，英特尔和BBVA等大公司。

所有这些都促进了区块链技术扩展到需要该技术提供的功能的许多领域：可靠性，不变性和可审计性。 事实上，区块链目前是近期最热门的研究课题之一，根据普华永道的统计，2016年前9个月仅创业公司就投入了超过14亿美元[10]。

#### 挑战

虽然区块链的关键思想很简单，但其实施却带来了许多挑战。 本节介绍其使用带来的主要问题。

###### 存储容量和可扩展性

存储容量和可扩展性在区块链中受到了深刻的质疑。 在这项技术中，链条总是在比特币中每10分钟以每块1MB的速度增长，并且在网络中的节点之间存储副本。 虽然只有完整节点（可以完全验证事务和块的节点）存储整个链，但存储要求非常重要。 随着规模的增长，节点需要越来越多的资源，从而降低了系统的容量规模。 此外，超大链对性能有负面影响，例如，它会增加新用户的同步时间。

事务验证是分布式共识协议的关键组件，因为期望区块链网络中的节点验证每个块的每个事务。块中的事务数量和块之间的时间调制所需的计算能力，这对事务确认时间有直接影响。因此，共识协议直接影响区块链网络的可扩展性。

考虑到比特币的信任模型及其可扩展性限制，Bitcoin-NG [11]提出了一种新的拜占庭容错区块链协议，该协议改善了比特币的共识延迟。 Litecoin [12]在技术上与比特币相同，但由于减少了块生成时间和基于scrypt（基于内存密集型密码的密钥派生函数）的工作证明，因此具有更快的事务确认时间和更高的存储效率.GHOST [13]旨在通过改变其链选择规则来提高比特币的可扩展性。离线解决方案[14]旨在执行链外交易，同时增加带宽，因为它增加了丢失数据的可能性。另一个建议建议减少比特币协议中的传播延迟[15]，但它可以危及网络安全。 BigchainDB [16]不是增加区块链的可扩展性，而是将区块链特征添加到大数据分布式数据库中。 BigchainDB将大数据分布式数据库的高吞吐量和低延迟特性与区块链的不变性和分散系统相结合。另一个重要的发展是行星间文件系统（IPFS）[17]。 IPFS是一种旨在存储分散和共享文件的协议，使P2P分布式文件系统能够使Web更安全，更快速，更开放。 IPFS旨在提高Web的效率，同时消除重复并跟踪每个文件的版本历史记录。

###### 安全：弱点和威胁

比特币协议已经过彻底分析[18]，并且已经发现了各种漏洞和安全威胁。
最常见的攻击是51％的攻击或多数攻击[19]。

如果区块链参与者能够控制超过51％的采矿能力，则可能发生此攻击。 在这种情况下，他可以控制网络中的共识。 采矿池的繁荣和快速发展（2014年GHash.io4暂时达到比特币采矿能力的51％），增加了这种攻击发生的可能性，这反过来又可能损害比特币的完整性。 此外，[20]中的作者讨论了通过贿赂获得大部分采矿权的可能性。 单独挖掘激励或P2P挖掘将有助于缓解这一问题。针对区块链提出的许多其他共识机制也容易受到多数攻击，尤其是那些在有限数量的用户中集中共识的攻击。

双重花费攻击包括花两次相同的硬币[21]。在比特币中，只有在存储交易的区块在区块链中具有一定深度（通常为5或6）之后，才应认为交易被确认。这平均需要20到40分钟[22]。确认时间存在很大差异，因为它取决于许多因素。在快速支付方案中，交易者无法承受这种等待。因此，在这些情况下，双重攻击仍然是可能的。

同样，种族攻击可以在这些情况下发挥作用。为了执行这种攻击，用户直接向商家发送交易，商家过快地接受交易。然后，用户向网络发送多个冲突的交易，将支付的硬币转移给他自己。第二次交易更有可能被确认，商家被欺骗。同样，Finney [23]攻击是一种更复杂的双重花费，因为它需要矿工的参与。

众所周知的拒绝服务攻击（DoS），中间人（MitM）或Sybil也可能阻碍网络运行。大多数P2P协议和物联网基础设施容易受到这类攻击，因为它们强烈依赖于通信。在eclipse攻击[24]中，攻击者可以独占一个节点的连接，将其与网络的其余部分隔离，并改变该节点的网络视图。

区块链网络中的代码更新和优化通常由加密货币社区的一部分支持，旨在改进其基础协议。这些改进在区块链术语中称为软叉和硬叉。一方面，软叉提供软件协议的更新，该协议识别与先前块的向后兼容性。这需要将大多数矿工升级到新软件。但是，大多数节点都遵守旧规则也会拒绝升级的功能。另一方面，硬叉对协议进行了彻底的改变，与先前的块和事务没有兼容性。因此，所有节点都必须升级到最新更新，并且将不再接受具有旧版本的节点。当硬分叉发生时，可以划分社区，从而产生两种不同的网络分支。如果没有像SegWit2x那样建立足够的共识，也可以取消硬叉[25]。该分裂的着名例子是以太坊和以太坊经典;和比特币，比特币现金和比特币黄金。上述硬叉与原始网络同时发展，现在它们相互竞争。节点和用户必须决定版本，并且分叉连续性将取决于这些决策。因此，分叉，尤其是硬分叉，可以将社区划分为两个完全不同的区块链，这可能对区块链用户构成风险。

除了围绕其实际价值的争议之外，虚拟货币的一个常见问题是硬币损失问题。 如果忘记钱包钥匙，则没有使用这些硬币操作的机制。 据估计，有30％的比特币丢失了。

最后，量子计算可能被视为对比特币的威胁，因为这些计算机的计算能力可能会破坏数字签名的安全性。 此外，随着时间的推移技术不断发展，每天都会发现新的错误和安全漏洞。 这些改进和错误可能会破坏加密数据的公共区块链，因为区块链数据是不可变的。

###### 匿名和数据隐私

在设计中，比特币协议没有强制实施隐私。 比特币的一个关键特征是它的透明度。 在区块链中，可以从系统的第一个事务中检查，审计和跟踪每个事务。 这确实是前所未有的新透明度，无疑有助于建立信任。 然而，这种透明度对隐私产生了连锁效应，即使钱包和个人之间没有直接关系，尽管比特币提供了一些机制，例如假名和使用多个钱包，但用户匿名似乎受到了损害。 从这个意义上说，已经做了一些努力来提供比特币中更强的匿名特性。 另一方面，不仅仅是开放虚拟货币，而且许多基于公共区块链技术的应用需要链中更高级别的隐私，特别是那些处理敏感数据的隐私。

在比特币中解决匿名问题的流行尝试是Zerocash [26]和Zerocoin [27]，它提出比特币扩展具有完全匿名的交易，隐藏发送者，接收者和信息本身。 Monero [28]使用一系列签名使事务无法追踪，因此无法轻易追溯到任何给定的人或计算机。

同样，由Bitcoin Fog [29]和Bit Laundry提供的交易混合服务或滚筒可以增加匿名性。这些服务将交易分解为较小的付款，并安排他们对交易进行模糊处理。然而，据说这些服务容易被盗。同样，最初在CoinJoin [30]中提出的硬币混合方法有助于对比特币进行匿名化。这个想法是用户同意联合付款，因此不能再假设交易输入来自同一个钱包。然而，通常由混合服务器执行的用户之间先前的协商可能缺乏所需的匿名性，这取决于实现。后来，这种方法启发了Dark Wallet [31]，这是一个允许完全私人匿名比特币交易的浏览器插件; Dash [32]，被称为第一个专注于匿名和隐私的加密货币; MixCoin [33]，它增加了加密问责机制和随机混合费用以提高安全性; CoinShuffle [34]建议对CoinJoin进行修改以提高安全性; CoinSwap [35]提出了一种基于包含接收硬币并使用未连接硬币进行支付的中介的四交易机制;和Blindcoin [36]增加了混合服务器的匿名性。一般来说，这些增加比特币匿名性的尝试通常包含维持放松管制的比特币的想法，因此通常被指控鼓励非法活动，例如在暗网上购买非法产品或洗钱。

为了增加隐私，可以加密区块链中的数据。 Hawk [37]存储加密的交易。 Hawk编译器负责将程序员编写的通用代码转换为加密原语，使事务中的信息匿名化。 除了加密之外，Enigma项目[38]将数据拆分为无法识别的块，并通过网络分发它们，使得任何节点都无法访问数据。 它使用可通过区块链访问的分散式离链分布式哈希表（DHT）来存储数据引用。

私有区块链中的隐私问题可以采用不同的方式解决，因为根据定义，它们必须提供认证和授权机制。但是，即使在私有区块链内，参与者也希望保留其数据的隐私。例如，Quorum [39]是一个基于以太坊的私有权限区块链，它使用加密技术来限制敏感数据的可见性和细分以增加数据隐私.Multichain [40]集成用户权限以限制可见性并引入对哪些事务的控制是允许的，哪些用户可以挖掘。 Rockchain [41]也基于以太坊，遵循以数据为中心的方法，可以对私有数据进行公共计算，可以获得保留数据隐私的累积结果。这种方法提供了一种分布式文件系统，允许用户通过以太坊中的智能合约来管理数据隐私。 Hyperledger Fabric [9]提供了一个专注于企业环境的分布式可扩展分类账。为了给区块链网络提供隐私控制，Hyperledger Fabric通过私有渠道提供身份控制服务和访问控制列表，用户可以通过私有渠道控制和限制对共享信息的访问在网络中。由于这种机制，网络成员通过他们的公共身份相互了解，但他们不必知道它在网络中共享的信息。

解决数据隐私的另一种方法是将敏感数据存储在链外，通常称为离线解决方案[42]。这种解决方案有利于管理大量数据的系统，因为将它们存储在区块链中是不切实际的。
此外，它们特别适用于处理应具有更严格访问控制的高度敏感数据的系统，例如医疗保健应用程序。通过这种方式，公共区块链可以用于存储锚数据，从而可以获得验证数据的完整性和时间戳的证据。用户可以在不依赖权限的情况下验证数据，只需检查区块链，并将数据安全地存储在外部。显然，这些脱链源必须具有容错能力，不应引入瓶颈或单点故障。在[43]中，作者提出使用Kademlia，一个众所周知的DHT来存储访问，控制和存储数据的键值对（用户身份和权限）。[44]一个指针和一个哈希来验证获得的数据存储在链中。通过这种方式，链中的数据是到私有数据的链接，并且散列是验证所获得的信息没有被改变的机制。提供了脱链源的访问控制机制，以确保只有授权方才能访问该信息。因此，可以使用区块链以安全且经过验证的方式从外部源获取信息。

###### 智能合约

1993年，Nick Szabo将智能合约定义为“执行合同条款的计算机化交易协议”。 智能合约的一个关键特征是它有一种强制执行或自行执行合同条款的方法。 在区块链技术出现之前，这在技术上是不可行的。Blockchain已经证明是支持智能合约的理想技术。 此外，智能合约对区块链的发展势头作出了重大贡献，而且这种耦合导致了第二代区块链，通常称为区块链2.0。 在没有集中控制的可信环境中自动执行合同的组合有望改变当前业务的完成方式。

基本上，智能合约代码存储在区块链中，每个合同都由唯一的地址标识，并且对于用户操作，他们只是向该地址发送交易。 区块链共识协议强制执行合同。 智能合约带来了一系列优势，例如降低成本，提高速度，精确度，高效率和透明度，这些优势促进了各种领域的许多新应用的出现。 尽管比特币提供了基本的脚本语言，但它已经证明是不够的，这导致出现了具有集成智能合约功能的新区块链平台。

最着名的智能合约区块链平台是以太坊[8]。 以太坊是一种内置的Turingcomplete编程语言的区块链，可以定义智能合约和分散的应用程序。 以太坊合同中的代码用“以太坊虚拟机代码”编写，这是一种基于堆栈的低级字节码语言。

金融智能合约通常需要访问有关现实世界状态和事件的数据。 这些数据由所谓的oracles提供。 这些实体对于智能合约在现实世界中的成功整合至关重要，但它们也会产生更多的复杂性，因为必须提供对oracles的认证，安全性和信任[45]。

智能合约的优势并非没有成本，因为它们容易受到一系列攻击[46-48]，带来新的激动人心的挑战。将合同执行委托给计算机会带来一些问题，因为它使它们容易受到黑客，漏洞，病毒或通信故障等技术问题的影响。合同编码中的错误尤其重要，因为系统具有不可逆转和不可改变的特性。验证和保证智能合同正确运行的机制对于客户和提供商广泛和安全地采用这些机制是必要的。合同逻辑的正式验证及其正确性是预计将在未来几年内做出贡献的研究领域[49]。

此外，现实生活中的合同通常具有无法量化的条款或条件。从这个意义上讲，为了对智能合约中的合同条件进行建模，仍然有很多工作要做，因此它们可以表示和量化，以便机器执行它们。此外，还需要努力为用户提供能够指定和理解智能合约的工具[50]。


###### 法律问题

缺乏一个中央机构，不存在的铸造厂实体，因此比特币的审查完全缺乏是一个有吸引力的，同时也是危险的特性。比特币用户通常被指控将网络用于欺诈目的，因此该技术被怀疑促进或促进非法行为。比特币作为第一个分散的加密货币产生了很多争议[51]。一方面，就其价值而言，一些专家声称这是一种欺诈[52]并且它将彻底崩溃[53]，而与此同时其他人估计其价值将在10年内达到100.000美元[54]欧洲央行已经警告其波动性风险，但也承认其作为金融创新的潜力[55]。然而，在缺乏治理方面，许多国家正在制定新的法律，以试图规范虚拟货币的使用（[56]提供比特币监管地位图）。这种情况造成了很多不确定性，似乎是最近垮台的原因[57]。

银行和政府将对货币是否成为法定货币发表意见。货币背景下的法律影响是一个重要问题，因为它们可以直接和负面地影响基于该货币的区块链应用。

最近出现了许多私有和许可的区块链应用程序。这些是向预定义对等体或对等体集授予写入权限的区块链。这可以为授权和认证机制带来一些好处，例如密钥恢复或事务赎回，并且还可以有助于简化隐私问题并减少事务延迟。事实上，如果当局负起责任处理，在比特币的保险范围内出现的有趣的市场机会则不再需要。控制网络的采矿池的威胁以及其他漏洞有利于开发此类区块链，政府显然对在许多应用中对该技术进行监管和控制使用感兴趣。但是，这意味着无信任网络将退回到第三方信任网络，失去其部分重要性。此外，如果解决方案包含集中式实体，这可能会产生瓶颈。这些区块链的功能更接近分布式数据库的功能。

另一方面，提高对这项技术的信心的关键可能是政府和/或大型公司财团参与其发展。 正在朝这个方向采取的举措将有所帮助[58,59]。 目前，个人信息分布在不同的实体中：政府，大学，公司等。 信息分布在许多实体上并且访问它是耗时的，即使所述实体是相同的权限，例如政府。除了缺乏保证信息的可信赖服务之外，这导致访问信息的障碍。 目前，具有每个人信息的值得信赖的全球身份服务将具有破坏性。 然而，每个国家都有自己的法律法规。

像Alastria [60]这样的倡议旨在让多个实体参与制定国家监管区块链，从公证人到大学和私营公司。他们计划为每个人提供公共和合法的钱包。公司也可以成为网络的一部分。因此，每个个人钱包可以是财产的数字证明，他/她工作的公司，大学学位等。对于许多服务，此信息可以以合法且可信赖的方式使用。例如，在求职面试的情况下，考生可以与面试官分享他们的大学学位和工作经验信息。根据定义，此信息可靠且可验证。这些举措是扩大政府机构内部区块链的关键，也是为区块链系统建立共同和监管框架的第一步。此外，这还可以促进人口的行政交易，以获取他们的信息，国家之间的数据传输，减少腐败信息以及人口，公司，政府和大学之间的无缝整合。然而，这也带来了获取高度私密信息的简便方法，因此本文其余部分所考虑的隐私和安全性必然与这些举措密切相关。

###### 共识

共识机制[61-63]负责区块链中信息的完整性，同时防御双重花费攻击，因此是区块链技术的重要组成部分。最终目标是在没有中央机构的分布式网络中实现共识，并且参与者不一定相互信任。

基于工作量证明（PoW）的共识，在比特币中如此成功，迫使矿工解决计算密集的易于验证的任务，以创建一个新的块。一旦解决，就会发布解决方案并将新块添加到链中。新块通过网络传播，其余参与者验证它并将其附加到其本地区块链副本。该过程可以同时发生在网络的不同部分。这就是链条实际上是一棵树的原因。区块链网络中同时存在多个有效的分支。当对等体附加新块时，它们还必须检查分支是具有最多累积工作（难度）的分支，即，假设为有效的分支的最长链。这样可以快速达成共识。一个关键的缺点是PoW使比特币依赖于能量消耗。上述51％的攻击是对比特币协议的潜在攻击。此外，随着采矿池的扩散确认，PoW的激励措施意外地促进了集中化。这与造币的减少，奖励减少和费用增加可能会在未来损害系统[64]。当然，PoW具有某些缺点，例如高延迟，低交易率和高能量消耗，使其不适合许多应用。如上所述，在许多情况下，10分钟的等待时间或块频率也可能是不切实际的。尽管如此，一些平台确实使用或改编了PoW，例如NameCoin，LiteCoin，以太坊，DogeCoin和Monero。例如，Primecoin通过提出有用的计算密集型任务来减轻能量损失，例如可以同时具有应用程序的素数搜索。

毫不奇怪，最近已经提出了许多改变PoW的尝试，可能低估了这种变化所暗示的复杂性，然而不清楚它们是否以与PoW相同的方式暴露安全属性。区块链中最常见的共识方法是股权证明（PoS）。它基于这样一个事实，那些拥有更多硬币的用户对系统的生存和正确运行更感兴趣，因此最适合承担保护系统的责任。基本上，使用PoS背后的想法是将机会成本从系统外部转移到系统内部。该算法根据他/她拥有的硬币数量随机确定负责创建每个块的用户。一个常见的批评是，这种方法不能为节点投票提供正确的激励（称为无关键问题）。此外，它在促进富人富裕的意义上是消极的。 PoS最初由Peercoin使用，后来在Nextcoin，Nxt [65]，Crave和Ethereum中使用。 PoS的变体是BitShares，Monax，Lisk或Tendermint的Delegate PoS（DPoS）。在BitShares [66]中，许多选定的证人通过将它们包含在块中来验证交易的签名和时间戳。选举通过投票进行，每当证人成功产生一个区块，就会得到奖励。这种方法允许代表在一秒钟内设置块延迟，块大小和确认事务

租赁的租赁证明（LPoS）允许用户将资金租赁给其他节点，以便更有可能选择创建块，增加可选参与者的数量，从而降低网络被单个网络控制的可能性节点组。奖励按比例分享。

烧伤证明（PoB）[67]建议刻录硬币，即将它们发送到可验证的不可靠地址，以便发布新块。像PoW一样，PoB很难做到并且易于验证，但相比之下不需要能耗。此外，PoB具有一些经济意义，有助于建立更稳定的生态系统。

Nem [68]达成共识的方法，称为重要性证明（PoI），将重要性值与每个帐户相关联，以此方式在网络中构建信誉系统。被选择创建块的机会取决于该值，其计算也考虑了硬币的数量和执行的事务的数量。换句话说，生产性网络活动也会得到奖励，而不仅仅是金额，促进用户的有用行为。

其他扩展变体是活动测试（PoA），一种结合了PoW和PoS的混合方法，以及由IBM开发的经过时间测试（PoET），它使用随机选择的管理器根据可靠执行环境中的运行时间挖掘每个块容量证明（PoC）[69]，也称为存储或空间证明，使用可用的硬盘空间而不是计算资源。这种方法用于Permacoin，SpaceMint和Burstcoin。

私有区块链具有特定功能，因为参与者的数量通常低于公共区块链并且是半可靠的。 它们通常在系统中使用预定义的权限集注册。 因此，这些系统需要符合这些特征的特定共识机制。

其中一些替代机制是Paxos [70]，由Lamport和Microsoft基于状态机复制开发; Chubby [71]，基于前者并由Google开发，定义为分布式阻塞服务。这些方法的优点在于它们是形式算法的改编，因此它们的特征已经被正式证明。 RAFT [72]分离了共识的关键要素，如领导者的选择，记录复制和安全性，并强制更大程度的一致性，以减少需要考虑的国家数量。实用拜占庭容错（PBFT）算法基于状态机复制和复制投票以实现状态变化的共识，用于Hyperledger和Multichain。 SIEVE [73]，将区块链视为一个
黑匣子，执行操作并比较每个副本的输出。如果副本之间存在差异，则不验证操作。 PBFT的另一个变体是拜占庭协议联邦拜占庭协议（FBA）。在FBA中，每个参与者都维护一个受信任的参与者列表，并等待这些参与者在被视为清算之前就交易达成一致。它用于Ripple [74]。 Stellar [75]是采用法定人数和部分仲裁概念的另一种变体。仲裁是一组节点，足以达成协议，部分仲裁是法定人数的一个子集，能够说服另一个给定节点有关协议。 HDAC [76]是一个目前正在实施的系统，它提出了一个基于Multichain的物联网合同和M2M交易平台。 HDAC专为物联网环境量身定制。它使用ePow一致性算法，其主要目标是激励多个采矿节点的参与并防止过多的能源浪费。

最后，Hydrachain提出的HC共识基于一系列验证者，其中不超过三分之一是不可靠的。

总而言之，公共区块链中的共识机制已被广泛提出，但尚未得到正式证实。 在使用它们之前，必须了解它们提供的保证及其漏洞[77]。 从这个意义上讲，研究界和行业必须努力验证这些机制，以证明其合法性。 相反，私有区块链采用了正式的众所周知的解决方案，但这些区块链中参与者的有限列表也限制了应用的多样性和潜力。

## 物联网和区块链集成

物联网正在转变和优化手动流程，使其成为数字时代的一部分，获取大量数据，提供前所未有的知识水平。这些知识正在促进智能应用的发展，例如通过城市服务的数字化改善公民的管理和生活质量。在过去几年中，云计算技术有助于为物联网提供分析和处理信息并将其转化为实时行动和知识的必要功能[1]。物联网的这种前所未有的增长开辟了新的社区机会，例如访问和共享信息的机制。开放数据范例是这些举措的旗舰。然而，正如许多情况中所发生的那样，这些举措中最重要的一个漏洞就是缺乏信心。像云计算中使用的集中式架构极大地促进了物联网的发展。然而，关于数据透明度，它们充当黑盒子，并且网络参与者没有清楚地了解他们提供的信息将在何处以及如何使用。

物联网和云计算等有前景的技术的整合已被证明是非常宝贵的。同样，我们也承认区块链在彻底改变物联网方面的巨大潜力。区块链可以通过提供可信的共享服务来丰富物联网，其中信息可靠且可追踪。可以随时识别数据源，并且数据随着时间的推移保持不变，从而提高其安全性。在许多参与者之间应安全地共享物联网信息的情况下，这种整合将代表一场关键的革命。例如，多种食品中的详尽可追溯性是确保食品安全的关键方面。食品可追溯性可能需要许多参与者的参与：制造，饲养，处理，分销等。链条任何部分的数据泄漏都可能导致欺诈并减慢搜索感染的过程，这会严重影响公民的生活，并在食源性疾病爆发的情况下给公司，部门和国家带来巨大的经济成本[78] 。更好地控制这些领域将提高食品安全性，改善参与者之间的数据共享，并减少食源性疾病爆发时的搜索时间，从而挽救人的生命。此外，在智能城市和智能汽车等其他领域，共享可靠数据有利于将新参与者纳入生态系统，并有助于改善其服务和采用。因此，区块链的使用可以用可靠和安全的信息补充物联网。这已经开始在[79]中提到，其中区块链技术被认为是解决与物联网范例相关的可扩展性，隐私和可靠性问题的关键。

从我们的角度来看，物联网可以从区块链提供的功能中获益，并将有助于进一步开发当前的物联网技术。 值得注意的是，为了将这两种技术无缝地结合起来，仍然需要研究大量的研究挑战和开放性问题，这个研究课题仍处于初步阶段。

更具体地说，这种集成可以带来的改进包括（但不限于）：

* 分散化和可扩展性：从集中式架构向P2P分布式架构的转变将消除中心的故障点和瓶颈[80]。它还有助于防止少数强大公司控制大量人员信息的处理和存储的情况。分散式架构带来的其他好处是提高了容错能力和系统可扩展性。它将减少IoT孤岛，并有助于提高物联网可扩展性。
* 身份：使用通用的区块链系统，参与者能够识别每个设备。提供并馈入系统的数据是不可变的，并且唯一地标识由设备提供的实际数据。此外，区块链可以为物联网应用提供可靠的分布式身份验证和设备授权[81]。这将代表物联网领域及其参与者的改进。
* 自治：区块链技术赋予下一代应用功能，使智能自主资产和硬件即服务的开发成为可能[82,83]。借助区块链，设备能够在不涉及任何服务器的情况下相互交互。物联网应用程序可以从此功能中受益，以提供与设备无关和解耦的应用程序。
* 可靠性：物联网信息可以在区块链中随时间保持不变和分布[84]。系统的参与者能够验证数据的真实性，并确保它们没有被篡改。此外，该技术还可实现传感器数据的可追溯性和可靠性可靠性是区块链引入物联网的关键方面。
* 安全性：如果将信息和通信存储为区块链的交易，则可以保护信息和通信[85]。区块链可以将设备消息交换视为由智能合约验证的事务，以这种方式保护设备之间的通信。物联网中使用的当前安全标准协议可以通过区块链的应用进行优化[86]。
* 服务市场：区块链可以加速创建服务和数据市场的物联网生态系统，同时可以在没有权限的情况下实现同行之间的交易。微服务可以轻松部署，微支付可以在无信任的环境中安全地进行[87-89]。它将改善物联网互连和区块链中物联网数据的访问。
* 安全代码部署：利用区块链安全不可变存储，代码可以安全并安全地推送到设备中[80,90]。 制造商可以最高的置信度跟踪状态和更新[85]。 物联网中间件可以使用此功能安全地更新物联网设备。

要考虑的另一个方面涉及物联网交互，即底层物联网基础设施之间的通信。 在整合区块链时，需要确定这些交互发生的位置：物联网内部，涉及物联网和区块链的混合设计，或通过区块链。雾计算[91]还通过在云计算和物联网设备之间包含一个新层来彻底改变物联网，并且还可以促进这种集成。 下面，描述这些替代方案（如图1所示）及其优缺点：

* IoT-IoT：这种方法在延迟和安全方面可能是最快的，因为它可以脱机工作。物联网设备必须能够相互通信，这通常涉及发现和路由机制。只有部分物联网数据存储在区块链中，而物联网交互则不使用区块链（图1a）。这种方法在具有可靠IoT数据的情况下非常有用，其中IoT交互以低延迟发生。
* IoT-Blockchain：在这种方法中，所有交互都通过区块链进行，从而实现不可变的交互记录。这种方法确保所有选择的交互都是可追踪的，因为它们的细节可以在区块链中查询，而且它增加了物联网设备的自主性。打算交易或租赁的物联网应用程序（如Slock.it）可以利用这种方法提供服务。然而，记录区块链中的所有交互将涉及带宽和数据的增加，这是区块链中众所周知的挑战之一。 （图1b）。另一方面，与这些交易相关的所有物联网数据也应存储在区块链中。
* 混合方法：最后，混合设计中只有部分交互和数据发生在区块链中，其余部分直接在物联网设备之间共享。这种方法的挑战之一是选择哪些交互应该通过区块链和提供在运行时决定这一点的方法。这种方法的完美编排将是整合两种技术的最佳方式，因为它利用了区块链的优势和实时物联网交互的优势。在这种方法中，雾计算可以发挥作用甚至云计算，以补充区块链和物联网的局限性。例如，雾计算涉及较少计算限制的设备，例如网关，并且可以是个挖矿的好地方[92,93]（图1c）。

在典型的物联网部署中，有限资源设备用作与负责将传感器数据转发到上层（云或服务器）的网关通信的终端节点。在集成区块链时，如果终端节点必须与区块链交互，则可以在IoT设备中提供加密功能。这是实现物联网自治的关键，这需要更复杂的硬件和更高的计算成本（在4.1.1节中，我们展示了在物联网设备中使用区块链的成本评估）。在这些解决方案中集成网关也是合理的，就像传统部署一样，但是以这种方式使用区块链的好处更少。尽管区块链的扩展，在许多应用程序中使用它是没有意义的，其中数据库提供足够的功能。决定何时值得使用区块链将主要取决于应用程序的要求。例如，当需要高性能时，单独的区块链可能不是正确的解决方案，但可以应用混合方法来优化它。在[94]中，作者提出了一种方法，用于根据问题要求确定区块链是否有用。接下来，我们将重点介绍如何在技术上实现物联网设备。

众所周知的公司之间的联盟已经开始出现，如可信赖的物联网联盟[59]，以弥合物联网和区块链之间的差距。此外，市场上有越来越多具有集成区块链功能的设备，如[92,93,95]。 EthEmbedded [92]支持在嵌入式设备上安装以太网完整节点，设备如Raspberry Pi，Beaglebone Black和Odroid。 Raspnode [93]和Ethraspbian [96]都支持在Raspberry Pi上安装比特币，以太坊和Litecoin完整节点。 [95] Antrouter R1-LTC [95]是一种WiFi路由器，也可以开发Litecoin。因此，这种类型的路由器可以安装在智能家居中，并成为雾计算生态系统的一部分。 Raspnode还支持比特币和Litecoin的钱包支持。正如Raspnode所述，挖掘可以在物联网设备上完成，但它将毫无用处。挖掘已经成为某些硬件（ASIC芯片）的专门任务，在物联网设备上尝试它是没用的。这就是为什么对物联网设备的挖掘工作很少的主要原因。仍然有许多研究要做，以实现物联网设备作为区块链组件的广泛集成。表2显示了用作区块链平台一部分的受调查物联网设备的摘要。

完整节点必须存储整个区块链（目前分别在比特币和以太坊中超过150和46 GB）才能完全验证事务和块，因此它们的部署在物联网设备中可能非常有限。如上所述，由于具体要求，采矿在物联网中将毫无用处。可以放宽共识协议以促进IoT设备的包含，但是这可能会损害区块链实现的安全性。这可以用于协调协议放宽的联盟区块链中。在轻量级节点的部署中，无需下载整个区块链即可验证事务的真实性，因此它们可以为区块链做出贡献，并且易于在物联网设备中运行和维护。这些节点可以在物联网中用作区块链网络的一部分，从而缩小两种技术之间的差距。这总是必须使用完整节点进行备份以验证事务和块。尽管如此，许多区块链还没有为轻量级节点提供支持，正如开发中的以太坊一样。在任何情况下，区块链都可以用作外部服务，以提供安全可靠的存储。

区块链与物联网集成的一个明显替代方案是物联网和云计算之间的集成[1]。 这种集成在过去几年中一直用于克服物联网的限制：处理，存储和访问。 但是，云计算通常提供集中式架构，与区块链相比，这使得与许多参与者的可靠共享变得复杂。 区块链和物联网之间的集成旨在解决除维护可靠数据之外的先前限制。 雾计算的目的是按照像区块链这样的分布式方法，将计算分布并更接近终端设备。 这可以包含比IoT更强大的设备，例如网关和边缘节点，然后可以将它们重新用作区块链组件。 因此，雾计算可以简化物联网与区块链的整合。

#### 区块链-物联网集成面临的挑战

本节研究将区块链技术应用于物联网领域时要解决的主要挑战。 区块链技术与物联网的整合并非易事。 Blockchain是为具有强大计算机的Internet场景而设计的，这远远不是物联网的现实。 区块链交易是经过数字签名的，因此能够使用货币操作的设备必须配备此功能。 将区块链纳入物联网是一项挑战。 本节介绍了一些已确定的挑战。

###### 存储容量和可扩展性

如上所述，区块链的存储容量和可扩展性仍然存在争议，但在物联网应用的背景下，固有容量和可扩展性限制使这些挑战更加严峻。 从这个意义上说，区块链可能看起来不适合物联网应用，但是有些方法可以减轻或完全避免这些限制。 在物联网中，设备可以实时生成千兆字节（GB）的数据，这种限制代表了与区块链集成的巨大障碍。 众所周知，一些当前的区块链实现每秒只能处理几个事务，因此这可能是物联网的潜在瓶颈。 此外，区块链不是为存储大量数据而设计的，例如物联网中产生的数据。 这些技术的整合应该应对这些挑战。
目前，存储了许多物联网数据，只有有限的部分可用于提取知识和生成动作。 在文献中已经提出了过滤，归一化和压缩物联网数据以减少它们的不同技术。物联网涉及嵌入式设备，通信和目标服务（区块链，云），从而节省了物联网提供的数据量。 可以使多层受益。 数据压缩可以减轻传输，处理任务和存储大量生成的物联网数据。 与异常数据不同，正常行为通常不需要额外的必要信息。
最后但并非最不重要的一点是，区块链，尤其是导致其瓶颈的共识协议，也可以通过调整来增加带宽并减少其交易的延迟，从而实现比特币NG的情况更好地过渡到物联网[11]]。

###### 安全

物联网应用程序必须处理不同级别的安全问题，但由于缺乏性能和设备的高异构性而具有额外的复杂性。 此外，物联网方案包括一组影响安全性的属性，例如移动性，无线通信或规模。 对物联网安全性的详尽分析超出了本文的范围，但详细调查可以在[97-100]中找到。

对物联网网络的攻击越来越多，其严重影响使得创建具有更复杂安全性的物联网变得更加必要。许多专家认为区块链是一种关键技术，可以在物联网中提供急需的安全性改进。然而，物联网与区块链集成的主要挑战之一是loT生成的数据的可靠性。区块链可以确保链中的数据是不可变的并且可以识别它们的转换，但是当区块链中的数据已经损坏时它们仍然会被破坏。腐败的物联网数据可能来自许多情况，而不是恶意的。物联网架构的福祉受到许多因素的影响，如环境，参与者，故意破坏和设备故障。有时，设备本身及其传感器和执行器从一开始就无法正常工作。在有问题的设备经过测试之前无法检测到这种情况，或者有时它会正常工作一段时间并因某种原因（短路，断开连接，编程过时等）而改变其行为。除了这些情况之外，还有许多可能影响物联网的威胁，如窃听，拒绝服务或控制[98]。因此，物联网设备在与区块链集成之前应进行全面测试，除了包括发现设备故障的技术外，还应将它们放置并封装在正确的位置以避免物理损坏。

这些设备更容易被黑客攻击，因为它们的约束限制了固件更新，阻止它们对可能的错误或安全漏洞进行操作。 此外，有时很难一个接一个地更新设备，就像在全球物联网部署中一样。 因此，应在IoT中放置运行时升级和重新配置机制，以使其随时间运行。 GUITAR [101]和REMOWARE [102]等计划在运行时实现了网络和固件更新，对于确保物联网与区块链的安全集成至关重要

物联网和区块链集成也会对物联网通信产生影响[86]。 目前，诸如CoAP和MQTT的IoT应用协议利用诸如TLS或DTLS之类的其他安全协议来提供安全通信。 除了需要集中管理和管理关键基础设施（通常使用PKI）之外，这些安全协议既复杂又繁重。 在区块链网络中，一旦连接到网络，每个IoT设备将具有其自己的GUID（全局唯一标识符）和非对称密钥对。 这将简化当前通常必须交换PKI证书的安全协议，并允许它们用于具有较低功能的设备。

在区块链采用的安全性方面，一个着名的物联网项目是Filament [83]。 Filament是一种硬件和软件解决方案，可为物联网中基于比特币的支付和智能合约提供功能。 灯丝设备具有嵌入式加密处理器，支持五种协议：Blockname，Telehash和智能合约，以及Pennyback和Bittorrent协议。 设备身份管理使用Blockname完成，而Telehash是Kademlia DHT的开源实现，提供安全的加密通信，智能合约定义了设备的使用方式。

###### 匿名和数据隐私

许多物联网应用程序使用机密数据，例如当设备链接到某人时，例如在电子健康情况下，解决数据隐私和匿名问题至关重要。 区块链是解决物联网中身份管理的理想解决方案，但在比特币中，可能存在需要保证匿名的应用程序。 这是可穿戴设备的情况，其能够在发送个人数据时隐藏人的身份，或者是保护用户的行程隐私的智能车辆。

已经讨论了透明和公共区块链中的数据隐私问题以及一些现有解决方案。然而，物联网设备中的数据隐私问题带来了更多困难，因为它从数据收集开始并延伸到通信和应用程序级别。保护设备以便安全地存储数据而未经许可不被人访问是一项挑战，因为它需要将安全加密软件集成到设备中。这些改进应考虑到设备资源的限制以及与经济可行性相关的限制。许多技术已被用于使用加密（IPsec，SSL / TLS，DTLS）保护通信。物联网设备限制通常使得必须使用诸如网关之类的约束较少的设备来合并这些安全协议。加密硬件的使用可以加速加密操作并避免复杂安全软件协议的过载。

保护数据和隐私是物联网面临的主要挑战，使用区块链技术可以减轻物联网中身份管理的问题。信任是物联网的另一个关键特征，区块链的整合可以发挥作用。在[103]中，信任对物联网系统的重要性被确定为确保其成功的主要目标之一。数据完整性技术是确保数据访问的另一种选择，因为它们可以避免使用物联网生成的大量数据来过载区块链。这可以导致公共系统，但具有有效且受限制的访问控制。 MuR-DPA [104]通过公共审计验证提供动态数据更新和有效验证。在[105]中，作者通过另一个私有的公共审计系统确保数据内容。有关完整性验证技术的广泛综述，请参阅[106]。

最后但并非最不重要的是，有一些法律规范数据隐私，例如欧盟的数据保护指令，需要修改以涵盖该技术所能实现的新模型。采用区块链作为法律平台应遵守这些法规，以确保遵守法律的数据隐私。

###### 智能合约

智能合约已被确定为区块链技术的杀手级应用，但如上所述，还有一些挑战尚待解决。 物联网可以从智能合约的使用中受益，但它们适合物联网应用的方式是多种多样的。

从实际的角度来看，合约是驻留在特定区块链地址中的代码（函数）和数据（状态）的集合。 合同中的公共职能可以由设备调用。 函数也可以触发事件，应用程序可以监听它们，以便对触发的事件做出正确的反应。 要更改合同的状态，即修改区块链，必须在网络中发布交易。 交易由发件人签名，必须由网络接受。

物联网能够在许多领域通过互联网进行感知和启动[1]。在食品可追溯性示例中，食品包装将配备有能够测量环境条件并连接到区块链（标志交易）的传感器。在区块链中，合同将提供开始装运，完成装运以及记录和查询测量的功能。当测量值超过预定义阈值时，将触发事件。管理应用程序将倾听这些事件，以及运输公司，零售商，
将通知制造商和客户。如果没有提出任何事件，那么区块链将保证货物在最佳条件下进行。智能合约将为物联网提供安全可靠的处理引擎，记录和管理所有交互。行动将是可靠和安全处理的结果。因此，智能合约可以安全地模拟物联网应用程序的应用程序逻辑。但是，在这种整合中应该解决以下挑战。

一方面，使用智能合约需要使用oracles，这是一种以可信方式提供真实数据的特殊实体。由于物联网可能不稳定，因此验证这些智能合约可能会受到影响。此外，访问多个数据源可能会使这些合同超载。如今，智能合约是分布式和分散式的，但它们不共享资源来分配任务并解决大量计算问题。换句话说，智能合约的执行仅在单个节点中完成，而同时代码执行由多个节点完成。此分发仅针对验证过程完成，而不是使用它来分发任务。物联网利用云计算和大数据的分布式功能来提高其处理能力。从那时起，数据挖掘技术已经能够整体解决物联网数据，从而更好地理解物联网，即通过云计算扩大的处理能力。大数据使得能够同时处理大量数据，允许从大型数据集中提取知识，这在以前很难做到。在物联网与区块链的集成中，智能合约应利用其分布式特性来实现物联网中其他范例（大数据和云计算）中提供的处理能力。

智能合约还应考虑物联网中存在的异构性和约束。 过滤和组机制应辅以智能合约，以使应用程序能够根据上下文和要求解决物联网问题。 发现机制可以enable device inclusion on the fly，使这些应用程序更强大。最后，直接来自智能合约的驱动机制将实现与物联网的更快反应。

#### 法律问题

不受管制的区块链的愿景是其本质的一部分，也是比特币成功的部分原因。如图所示，区块链，特别是在虚拟货币的背景下，带来了很多关于合法性的争议。通过网络引入控制元素的需要或机会来自许可的私有和联盟区块链。

物联网域名也受到有关数据隐私的国家/地区法律或法规的影响，例如数据保护指令。这些法律中的大多数已经过时，需要进行修订，特别是自新的破坏性出现以来
，例如区块链等技术。新法律和标准的制定可以简化设备安全功能的认证，并以此方式帮助构建最安全和可信赖的物联网网络。从这个意义上讲，处理信息隐私和信息处理的法律仍然是在物联网中应对的一大挑战，因此如果与区块链结合使用，将是一个更大的挑战。

如上所述，缺乏监管会产生缺点，因为私钥检索或重置或交易回复的机制是不可能的。 一些物联网应用程序设想了一种全球独特的设备区块链，但目前还不清楚这种类型的网络是由制造商管理还是向用户开放。 无论如何，预计它将需要法律监管。 这些法规将对区块链和物联网的未来产生影响，因此可能通过引入一个控制的，集中的参与者（如国家）来破坏区块链的分散和自由性质。

#### 共识

在物联网应用的背景下，设备的有限资源特性使它们不适合直接参与共识机制，例如PoW。如上所述，对于共识协议有各种各样的建议，尽管它们通常是不成熟的，并且尚未经过充分测试。资源需求取决于区块链网络中共识协议的特定类型。通常，解决方案倾向于将这些任务委托给能够提供此功能的网关或任何其他无约束设备。可选的方案，如在区块链外移动信息以减少区块链中的高延迟的离线解决方案，可以提供该功能。

尽管有将区块链完整节点纳入物联网设备的举措[92,93]，但?于其局限性，采矿仍然是物联网中的一个关键挑战。物联网主要由资源受限设备组成，但在全球范围内，物联网具有潜在的巨大处理能力，考虑到预计到2020年其中的设备数量将达到200至500亿之间。研究工作应集中在该领域并利用物联网的分布式性质和全球潜力来调整物联网中的共识。

在Babelchain [107]中，提出了一种名为Proof of Understanding（PoU）的新型共识协议，旨在使PoW适用于IoT应用。由于能耗较低，协议不是使用矿工来解决哈希谜题，而是提出了从不同协议进行翻译。通过这种方式，努力更多地集中在有用的计算上，同时解决物联网通信中的关键问题。网络中的Peers不是就交易状态达成一致，而是同意消息含义（格式，内容和行动）。此外，区块链数据提供了学习信息，如学习集。

## 平台和应用程序

最近，由于区块链技术提供的优点，区块链平台和应用已从许多不同领域中出现。 本节将介绍将物联网和区块链结合起来的最具代表性的应用程序和平台。

#### 用于物联网的区块链平台

区块链已被确定为一种可以强烈影响许多行业的颠覆性技术。 平台的数量如此之高并且不断变化以至于无法对它们进行全面分析，在本节中我们将重点关注最受欢迎且最适合的物联网域。

比特币是第一个加密货币和第一个区块链平台。 它提供了一种以快速，廉价和可靠的方式进行货币交易的机制，可以作为安全支付系统集成到应用程序中。 在物联网领域，自主设备可以使用比特币进行小额支付，主要用作钱包。 通常，当区块链的使用仅限于小额支付时，应用程序附加到货币上，这可能是一个缺点，因为硬币的贬值会对应用程序产生负面影响。 正如上文所述，使用智能合约将在区块链与物联网集成时是一种常见的解决方案。 比特币包括一种脚本语言，允许在执行交易时设置特定条件。 但是，与其他智能合约平台相比，脚本编写非常有限。

如上所述，其中一个最近发生重要影响的平台是以太坊[8]。 以太坊是包含智能合约的先驱区块链之一。 以太坊既可以被描述为具有内置编程语言（Solidity）的区块链，也可以被描述为全球运行的基于共识的虚拟机（以太坊虚拟机EVM）。 包含智能合约使区块链远离货币，促进了该技术在新领域的整合。 这与其活跃和广泛的社区一起使以太坊成为开发应用程序最受欢迎的平台。 大多数物联网应用程序使用以太坊或与之兼容（参见表6）。 最简单的方法是定义智能合约，其中设备可以发布其对变化做出反应的度量和策略。

Hyperledger [9]也产生了很大的影响。 
Hyperledger是一个开源平台，在这个平台上开发了与区块链相关的各种项目，其中包括Hyperledger Fabric，一种没有权限的区块链，也没有加密货币，IBM的Blockchain平台等商业实现都是基于此。 它为共识和成员提供了不同的组件。 可以使用通用语言在区块链中开发分布式应用程序。 物联网设备可以通过IBM Watson IoT平台向区块链提供数据，IBM Watson IoT平台管理设备并允许数据分析和过滤.IBM的Bluemix平台通过提供区块链技术作为服务，简化了区块链技术的集成。 该平台的使用加速了应用程序原型设计，并开发了几个用例。 正在进行的食品可追溯性项目正在使用这个平台[108]。

Multichain平台允许创建和部署私有区块链。 Multichain使用API扩展原始比特币API的核心，具有新功能，允许管理投资组合，资产，权限，交易等。此外，它还提供了一个命令行工具，用于与网络和不同的客户进行交互可以通过JSON-RPC与Node.js，Java，C＃和Ruby等网络进行交互。 Multichain是比特币核心的分支，其源代码可编译为64位架构。在[109]中，多链区块链集群部署在三个节点上，其中一个节点是arduino板，作为IoT-blockchain应用程序概念的证明。

如上所述，Litecoin [12]在技术上与比特币相同，但由于减少了块生成时间（从10分钟到2.5）并且工作证明基于scrypt，一种基于密码的内存密钥派生函数，因此具有更快的交易确认时间和更高的存储效率。这意味着Litecoin节点的计算要求较低，因此更适合IoT。

Lisk [110]提供了一个区块链平台，其中子区块链或侧链可以用分散的区块链应用程序和加密货币的选择来定义（例如比特币，以太坊等）。 Lisk被称为javascript开发人员的区块链平台，还支持在平台内创建和部署分散式应用程序，供最终用户直接使用，从而创建可互操作的区块链服务生态系统。 开发的应用程序可以使用LSK货币或可以创建自定义令牌。 Lisk使用委托的股权共识证明。Lisk正在与物联网合作，研究区块链技术是否能有效地在物联网内建立安全性。

Quorum [39]是一个区块链平台，旨在为金融服务行业提供以太坊的许可实施，并支持交易和合同隐私。它允许多种共识机制，并通过加密和分段实现数据隐私。该平台最近集成了ZeroCash技术，以掩盖有关交易的所有可识别信息。 Quronicum平台已被Chronicled [111]用于在物理资产和区块链之间建立安全链接。

HDAC [76]是一个基于Blockchain的物联网合同和M2M交易平台，目前正在开发中。 HDAC系统使用公共和私有区块链的组合，以及量子随机数生成来保护这些交易。启用HDAC加密货币的公共区块链可以有效地与多个私有区块链一起使用。 Hdac IoT合同概念证明将于今年推出。

表3显示了用于创建本节调查的IoT应用程序的区块链平台的比较。大多数平台都存在智能合约，从而使应用程序逻辑能够超越加密货币交易。在区块链部署的情况下，有或没有加密货币的区块链之间存在二元性。具有像以太坊这样的加密货币的既定平台可以为区块链应用程序提供所需的基础架构。这可以被视为部署您自己的云基础架构或使用AWS Amazon或Google Cloud Platform。
然而，在区块链的情况下，分布是其可信赖性的关键。另一方面，使用像Hyperledger Fabric这样的非加密货币平台需要加入一个联盟和基础设施来启动区块链。 PBTF和PoS是最常用的共识。在大多数平台上都有权限和隐私，因此可以从中创建联盟和全局应用程序。

###### 评估

为了测试在物联网设备上运行区块链平台的可行性，我们使用Raspbian Stretch OS和Linux内核4.9.59-v7 +在Raspberry Pi 3模型B上安装并运行了来自不同平台的不同节点。为了进行这些实验，该设备配备了128GB的SD卡（Samsung EVO PLUS MB-MC128GA / EU）。 Raspberry通过以太网连接到Internet。安装并运行不同类型的节点，连接到公共网络。我们测量了能量消耗并收集了与任务性能相关的一些测量值，每次测试30分钟。能量消耗是通过测量电源和Raspberry Pi之间的电流获得的，Moteino Mega配备了INA219直流电流传感器。结果是通过与Moteino Mega的串行连接在PC上获得的。为了评估任务性能，运行后台进程收集以下任务数据：cpu和内存的使用百分比，任务所需的虚拟内存量以及带宽消耗（发送和接收的字节）。这是通过top.1 Unix命令和每个进程的监视器网络带宽使用工具nethogs2完成的。表4总结了结果。每个核心的CPU测量值为100％，因此我们的四核设备的最大值为400％。

注意，不同类型的节点实现不同的功能，并且不同区块链中的相同类型的节点也执行不同的任务。节点连接到公共区块链网络，如比特币，以太坊和Litecoin，以在实际工作条件下测试设备。此外，当连接到公共网络时，我们无法控制网络的状态，即每次实验期间发布的交易数量不同。因此，该评估并非旨在对不同实现的性能进行详尽的比较，而是提供在IoT上使用区块链节点的可行性以及陈述技术难点的概念。

为实验选择的节点是在公共网络中运行的具有Raspberry Pi兼容性的节点，因此节点可以采用部分路由协议。为了能够比较结果，我们还测量了Raspberry运行Raspbian的能耗，并且没有安装任何节点，获得272.09 mA。 Raspberry Pi采用5 V电源供电。

首先，我们测量了光节点的性能。例如，比特币光节点（Electrum实施）相对于Raspberry基础测量（272.09 mA），能耗增加不到4％。非常类似于Litecoin光节点（Electrum实现）获得的值，其增加了5％。以太坊光节点未经测试，因为它目前正在开发中。关于任务性能，两个轻节点的CPU使用率和虚拟内存也非常相似。内存的使用存在更多差异，其中比特币消耗了2％的额外内存。带宽消耗主要在接收字节方面有所不同，其中Litecoin下载了近36 Kb。结果表明，这些光节点在Raspberry Pi上运行舒适，它们提供了进行安全交易的功能，这足以从区块链功能中受益，并且不需要过多的内存，也不需要高能耗。下一节介绍几种解决方案，其中这些类型的节点用于物联网区块链应用程序。

接下来，使用完整节点进行实验：以太坊完整节点（Go实施），比特币全节点（比特币核心实施）和Litecoin完整节点（Litecoin核心实施）。如上所述，以太坊完整节点的功能与比特币节点的功能不同。首先，不同的共识协议PoS和PoW具有完全不同的计算要求。此外，完整节点需要同步过程来下载整个链，在此过程中，计算要求预计会更高。为了评估不同的消耗要求，在同步期间和之后进行测量。在测试时，Litecoin的区块链大小为14.03 Gb，以太坊链为49.47 Gb，比特币链为155.8 Gb。请注意，由于当前比特币链大小超出了我们测试场景的内存，因此无法测试同步后的完整比特币节点。以太坊同步大约需要5天（由于系统故障导致多次重启），而Litecoin大约需要2天。此外，在接近完全同步（少于100个块到达它）几天后，我们决定评估其当前状态的以太坊全节点，99.99％进行完全同步。我们认为99.99％是完全同步的良好近似值。生成的新块的数量以及Raspberry Pi对该完整节点的有限功能使得难以实现完全同步。

与光节点相比，全节点实现的附加功能（主要是存储）在内存和CPU中的较高消耗值中被观察到。正如预期的那样，在同步之后获得的大多数值低于它期间。在同步后的以太坊完整节点中，相对于同步期间的值，使用的平均CPU低5倍，平均内存使用低2.8倍。

与Raspberry基础测量（272.09 mA）相比，在同步期间，以太坊节点的能耗增加了120％，而比特币全节点则为57％，Litecoin为60％。同步后这些值对于以太坊来说增加了36％而对于莱特币来说不到3％。 CPU和内存的使用在整个节点中也有所增加，特别是在同步期间，最高消耗值是以太网节点，平均达到CPU使用率的256％和86％的内存。然而，在同步之后，这些值分别降低到47％和29％。对于Litecoin，同步期间CPU使用率为117％，同步后CPU使用率仅为7％。块验证是CPU密集型的，因此在链同步后CPU使用率下降是正常的。相比之下，Litecoin中的内存使用率在同步后从19％增加到51％。这可能是由于其内存密集型共识协议。正如预期的带宽值飙升，与光节点相比，因为它们存储了整个链。而对于光节点，带宽值大约为Kb，而完整节点大约为Mb。比特币全节点接收的字节数比其轻节点多13000倍，同步期间Litecoin完整节点比其轻型版本多5千倍，同步后仅为20倍。

很少有情况下，使用完整节点IoT是有意义的。我们还没有找到任何在物联网中使用它的应用程序。它可以用于私有部署和测试目的，但我们知道在最终的应用程序中，还有其他更合适的设备来运行这些节点。评估结果表明，在物联网上使用这些节点的可行性非常有限。如上所述，光节点更适合有限的资源设备，例如物联网中的那些。

测试期间最值得注意的问题是难以找到有关物联网设备页面上不同节点实现的最新信息，以及在某些情况下的高安装时间和完整节点的非常高的同步时间。此外，在某些情况下，例如以太坊，物联网设备的正确配置是必要的，否则整个节点将使Raspberry崩溃。官方文档和实现对于上述节点的部署非常有用。

#### 区块链应用程序

在财务方面，出现了一种显着的替代加密货币（altcoins，1486，根据coinmarketcap），已经建立了一个新的市场，并实现了新的支付和投资形式。它们的例子有Ripple [74]，Litecoin [12]，Nxt [65]，Peercoin [112]，Bitshares [66]，Dogecoin [113]，Namecoin [114]，Dash [32]和Monero [28]。这个新市场也导致了这些新货币的支付，交换和交易基础设施的新应用程序的出现。

除了财务之外，区块链的分布式和无信任分类帐已被确定为可追溯系统的理想解决方案。比特币的经济交易是什么，已经成为绘制对象的变化。通过这种方式，链条可以存储对象及其所有变化，从而实现完整，开放和可靠的可追溯性，只有通过这种技术才能实现。来自IBM，联合利华，沃尔玛和雀巢等知名公司的一些正在进行的项目合作进行食品可追溯性[108]或雷诺跟踪汽车维修历史[115]。

身份验证也已成为该技术的流行应用，区块链提供了一个可用于存储身份的开放可信分布式分类账。这使得身份的全球管理成为可能。在电子政务领域，许多国家提出使用区块链技术，例如：迪拜的护照[116]，爱沙尼亚的电子身份[117]，伊利诺伊州的出生证明数字化[118]以及印度的土地登记[119]。

此外，智能合约的整合为许多行业开辟了一个充满可能性的世界：能源，保险，抵押，音乐特许权使用费，房地产，赌博，投注等。云存储，教育或电子医疗是其他领域
已提出区块链应用程序。表5列出了不同领域的一些应用程序。

##### 物联网区块链应用程序

尽管在物联网中使用区块链是相对较新的，但已经有大量的提议，其中该技术以不同的方式用于改进当前的物联网技术。 表6列出了其中一些提案的摘要。

实际上，在许多情况下，物联网可以与区块链结合使用。几乎所有可追溯性应用程序都可以从包含物联网设备中受益，例如，附加到要跟踪的产品的传感器可以在其分发期间提供信息。 类似地，通过提供感测数据来数字化世界的许多应用可以通过区块链技术来丰富。 它可以帮助提高数据的合法性或可靠性，而且无需中央机构就可以提供分布式身份，身份验证和授权机制。

区块链可以成为实现智能城市概念的有力候选者。智能城市的概念基于可以自主工作的智能物联网设备。区块链可以增加设备的自主性，因为它通过提供分布式开放式分类帐来简化交互和协调，其中设备可以可靠地查询可信信息。此外，区块链的自主性有利于创建新的物联网市场。 [85,87-89]。

如表6所示，以太坊是物联网区块链应用程序最受欢迎的平台。以太坊提供比比特币更多的功能，智能合约的包含极大地扩展了可能的应用程序。

在LO3 Energy [87]中，使用区块链的能量微网已在布鲁克林（美国），德国南部和南澳大利亚得到证实。微电网是发电，储能和电力负荷的局部分组。该项目建立了一个社区能源市场，创建了一个与更广泛的电网协调的分散式P2P能源网络。它是有史以来第一个能源区块链平台，它允许电网边缘的设备安全直接地进行交易，以便在微电网参与者之间进行能源销售。混合设备测量建筑物在使用中的能量产生并将数据发送到网络。

由IBM和三星[80]领导的自主分散点对点遥测（ADEPT）项目旨在促进设备自治，为此他们使用区块链技术确保边缘设备上的代码执行。 ADEPT使用三种协议：Telehash，Bittorrent和Ethereum，分别用于消息传递，文件共享和区块链。区块链技术提供身份验证，参与，合同和清单。他们的概念证明在于智能洗衣机，它使用智能合约从零售商处购买洗涤剂。

Slock.it [85]提出的区块链框架旨在解决数十亿物联网设备的安全性，身份，协调和隐私问题。目标是建立一个共享经济，每个物联网资产都可以安全快速地租用，而无需任何权限。他们正在开展各种项目，例如为电动汽车提供充电基础设施的市场，称为Blockcharge。该解决方案使用smartplug，移动应用程序来激活插头并控制费用，以及区块链来支付服务费用。他们还在开发智能锁，以实现公寓租赁的自动化。

Aigang [88]是物联网资产的自主保险网络。
Aigang已经在以太坊测试平台上部署了智能合约，该测试平台自动发布政策，进行风险评估和处理索赔。他们还创建了自定义虚拟货币（AIX）。它们为不同风险等级和潜在收益的不同产品提供投资机会。智能合约将智能设备与保险政策相结合。通过这些合同，设备可以订购维护，并且保险支付可以自动化。通过包含Oracles报告事件，可以自动处理索赔处理。

MyBit [89]计划建立一个服务生态系统，物联网资产（从无人机到汽车）由一群人拥有，收入是共享的。任何人都可以获得新的融资模式和投资机会。以太坊智能合约用于自动化流程：当物联网设备产生收入时，投资者自动获得与其所有权股份成比例的利润份额。中央智能合约负责平台的控制，维护和更新。该平台定义了不同的资产类型，物联网设备与资产相关联，一旦安装，它们就会通过API发送和请求信息。 Oracles用于将设备连接到网络。

AeroToken [148]旨在为低空商业无人机服务创建实时导航和财产访问授权系统。它们通过自愿在属性上共享空域来提供无人机导航的解决方案。这有助于解决无人机操作许可问题，构建新的共享市场。业主在区块链中使用智能合约提供其空域，无人机服务提供商支付临时访问费用。该应用程序是使用以太坊智能合约开发的。

Chain of things[146]是一个支持区块链的物联网研究实验室，它提出了Maru，一个集成的区块链和物联网硬件解决方案。区块链为设备提供出生，安全和互操作性的通用身份。提出了三个案例研究：安全链，侧重于通过区块链为物联网提供安全保障; Chain of Solar旨在将太阳能电池板连接到区块链，以便为各种应用和运输链存储生产的能源，计划提高航运和物流行业的安全性。数据记录设备用于将数据发送到网络。已经在以太坊网络上开发了概念验证。

Chronicled [111]开发了多种具有加密功能的物联网产品，旨在创建世界上最值得信赖的物联网和供应链生态系统。 Chronicled平台包括一个区块链同步服务器，能够与多个区块链系统同步，如Quorum，Ethereum和Hyperledger。通过智能合约执行设备标识的注册和验证。

Modum [84]区块链解决方案旨在为物理产品提供数据完整性，专注于改善供应链流程。 Modum传感器记录出货期间的环境条件。 Modum旨在与不同平台协同工作。已经使用以太坊区块链开发了用于分发医疗产品的解决方案。以太币智能合约用于在每次货物更改所有权时验证传感器数据，合同验证交易符合客户的标准。该解决方案集成了传输过程中收集测量值的传感器标签，用于连接和激活传感器并更改所有权的移动应用程序，以及用于在装运接收后分析传感器收集数据的仪表板。

Twin of Things是一种解决方案，用于确保Riddle和Code开发的日常物品的所有权和来源[147]。该解决方案结合了区块链和加密技术，为所有连接的物理对象生成基于硬件的数字身份。借助区块链，设备之间的通信和交易可以自动安全地执行。高度安全的加密芯片使每个设备成为区块链节点。该芯片以粘合剂不可移动NFC标签的形式生产，并且Android应用程序用于执行区块链交易以注册芯片的独特防篡改身份。一旦在网络中验证，它就可以与其他设备进行交互。该解决方案被设计为区块链不可知，它目前可以与以太坊，比特币和BigchainDB区块链一起使用。

Blockchain of Things[82]为工业物联网集成提供了一个安全的开放式通信平台。 他们提出了Catenis，一种用于快速比特币区块链集成的Web服务层，具有端到端加密功能。 它也可以适用于以太坊，Hyperledger和其他区块链。 在Catenis中，每个物联网设备都表示为Catenis Hub和Gateways中的虚拟设备（具有更高的安全性）。 每个虚拟设备都将为物联网设备管理一系列Catenis服务。


## 结论和未来的工作

颠覆性技术总是引起很大的争议。尽管存在许多虚拟货币的批评者，但似乎不可否认的是，支持它们的技术是一项重大的技术革命。 Blockchain就在这里。但是，在没有充分保证其运行的情况下，修改技术或将其应用于成本不能弥补改进的情况，是人们可以轻易陷入的风险。因此，应该仔细分析将区块链应用于物联网的好处并谨慎对待。本文分析了区块链和物联网必须解决的主要挑战，以便它们能够成功地协同工作。我们已经确定了区块链技术可以帮助改善物联网应用的关键点。还提供了一项评估，以证明在物联网设备上使用区块链节点的可行性。现有的平台和应用程序也已经过检查，以完成研究，提供区块链技术与物联网范例之间相互作用的完整概述。

预计区块链将彻底改变物联网。考虑到本文中提出的挑战，应该解决这两种技术的整合问题。法规的采用是区块链和物联网作为政府基础设施一部分的关键。这种采用将加速公民，政府和公司之间的互动。在将物联网作为采矿过程的一部分并分配更多区块链的过程中，共识也将发挥关键作用。然而，数据可信度与促进嵌入式设备的包含之间可能出现二元论。最后，除了影响两种技术的可扩展性和存储容量之外，还应该进行研究以确保物联网和区块链可以成为关键技术的安全性和隐私性。

区块链，特别是加密货币的一个主要问题在于其波动性，人们也利用这种波动来不公平地利用这种情况。物联网和区块链的整合将极大地增加区块链的使用，以便在与当前信托资金相同的水平上建立加密货币。
