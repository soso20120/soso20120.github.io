---
layout: post
title: A Distributed Ledger for Supply Chain Physical Distribution Visibility
tags:
- Blockchain
- Supply Chain

---

## Abstract

供应链（SC）涵盖许多地理位置，模式和行业，涉及数据从供应商，制造商，分销商，零售商和客户双向流动的几个阶段。此数据流对于支持可能影响产品成本和市场份额的关键业务决策是必要的。当前的SC信息系统无法在分发阶段提供经过验证的伪实时货运跟踪。这些信息可以从单一来源获得，通常是承运人，并根据需要与其他利益相关者共享。本文介绍了一个独立的，经过人群验证的在线货运跟踪框架，该框架补充了当前基于企业的SC管理解决方案。拟议的框架由一组私人分布式分类账和一个区块链公共分类账组成。每个私人分类帐允许在给定货件中私人共享贸易伙伴之间的监管事件。例如，在交易高端产品或化学和医药产品时，隐私是必要的。第二种类型的分类帐是区块链公共分类帐。除了监视事件之外，它还包含每个私有事件的哈希码。后者使用通勤者采购从大量来源提供独立验证的不可变记录，表明货物的伪实时地理定位状态。

## INTRODUCTION

我们的主要目标是在供应链（SC）的物流阶段为供应商和客户提供经过验证的近实时可见性。该阶段涉及货物从供应商到客户的运输。在SC的物流分配阶段，有几种现有的解决方案支持货运跟踪。这些解决方案通常包含来自单一来源，运营商的跟踪信息，并且受到其他利益相关者的可见性限制。实际上，信息是通过承运人在必要时提供的更新来共享的。此外，共享的信息不由独立来源验证。这些信任和透明度问题可能不会影响具有完全集成的入站和出站物流网络的大型企业之间的交易[1]。但是，当客户或供应商是中小型企业并且在装运期间必须依赖负载共享和多个运营商时，该模型会失败。

本文介绍了一个框架，该框架在SC的分发阶段向所有利益相关者提供在线货运跟踪信息。信息流和交换由两种类型的分布式分类账支持：私人分类账和公共分类账。每批货物都与特定的私人分类帐相关联，该分类帐仅由货件中涉及的贸易伙伴共享。这种设计选择似乎违背了本文提出的透明度原则。但是，我们认为，当交易产品价值高，危险或可能具有双重用途（例如药品和化学产品）时，有必要保持一定程度的隐私。私人分类帐包括与特定货件相关的托管事件。示例costody事件可以是将货物从供应商转移到承运人或从承运人转移到客户。

第二种分类帐是公共分类帐。建议的框架中只有一个公共分类帐，它包括外部监视器发布的事件以及发布到私有分类帐的所有监管事件的哈希值。监视器是commuters，可以验证卡车的地理位置，然后由贸易伙伴通过私人分类帐中的信息将其与特定货物相关联。commuters增强了跟踪信息的有效性，并支持该信息的伪实时传送。除了监视事件之外，公共分类帐还包括私有监管事件的哈希值。如上所述，custody事件仅由特定于发货的贸易伙伴共享。但是，通过将其哈希值发布到公共分类帐来维护这些事件的公共记录。此公共记录为监护事件提供了额外的验证机制。

**虽然本文侧重于区块链技术在物流管理阶段支持供应链可视性的具体应用**，但它也试图解决完全私有/许可和完全公共/开放区块链架构之间的更广泛鸿沟。任何类型的架构的优点和缺点已在[2]中讨论过。但是，需要对结合两种类型的分类账的信任架构进行更多的研究[3]，特别是在敏感信息的保护至关重要时。

所提出的系统的体系结构是分布式的，并且使用混合的对等通信模型[4,5]。本文特别关注**数据模型和数据表示**。底层数据模型使用EDI-214（电子数据交换）标准[6]翻译成JSON（JavaScript Object Notation）[7]，以保持与现有SC信息系统的互操作性。框架的其他方面，例如与**用户认证和加密密钥管理相关的方面，超出了本文的范围**，因此不再详细讨论。

本文第2部分是对以前相关工作的回顾。第3节介绍了框架，并讨论了用于分类账和基础事件的数据表示，以及支持将这些事件发布到私有和公共分类账的流程。第4节介绍了框架的实现，并使用测试场景举例说明了操作框架。第5节总结了本文，重点介绍了未来工作的主要贡献和总结方向。

## Related Work

本节介绍SC管理系统的演变以及区块链技术及其应用的现有技术状况。

在过去几十年中，在SC管理系统领域取得了重大进展。 ERP（企业资源计划）解决方案的成熟度和采用水平的提高使公司能够有效地管理仓储，订单管理，融资，计费等内部物流流程。此外，对国内和国际贸易的需求不断增加导致B2B的出现（企业对企业）平台由供应链运营网络（SCON）提供支持[1]。这些网络通常以供应商为中心，服务于特定的行业。市售SCON解决方案的例子包括E2Open [8]和SAP（Systems Applications and Products）[9,10]。 SCON可以与组织的ERP集成，并使用标准EDI [6,11]消息传递实现贸易伙伴之间的信息交换（图1）。它们非常有效地将一组目标交易（例如，采购订单和提单）从给定成员暴露给其他贸易伙伴。然而，SCON最近才开始适应从供应商管理的物流到第三方管理的物流的转变。实际上，在过去十年中，大型制造商开始将其物流分销外包给第三方物流运营商[10]。这使制造商能够专注于他们的核心业务。然而，随着国内和国际贸易的扩大，这一趋势创造了复杂的物流网络。为了克服这些复杂性，运输管理系统（TMS）开始从用于车辆跟踪的传统车队管理系统演变为包括诸如装运级跟踪之类的附加服务[12]。我们认为，这种演变仍然受到限制，原因如下：（1）跟踪信息未得到验证，（2）多个运营商的连续性得不到保证;（3）跟踪信息仍由运营商管理，并根据需要进行披露给其他利益相关者对于具有扩展资源和大量产品的一级企业来说，这些限制很容易克服，因为它们可以规定参与规则。中小型企业（SME）产品数量较少，合作伙伴数量较多。因此，由于成本和引入新的SC管理实践的困难[12,14]，这些限制构成了一个主要障碍并限制了中小企业进入不同SCON [13]的机会[12,14]，这反过来又阻碍了它们轻易渗透新的市场。提出的解决方案旨在通过使用紧急区块链技术[15]解决上述障碍并为SC物流配送提供分布式解决方案。

正如[15]中最初提出的，区块链是一个分布式公共数据库（分类帐），它维护着一个不断增长的事务列表，这些事务按块组织并防止被篡改。支持两种类型的交易：创造价值的创世纪交易和将价值从一方转移到另一方的转移交易。每笔交易都由发行人进行数字签名并发布到分类账。然后将一组交易收集到由第三方（矿工）验证的块中。链中的每个块都是不可变的，因为它链接到它的前任，并且对任何块的任何更改都会使链中下游的所有块无效。此外，块越成熟（即，它在分类帐链中越长），其完整性就越大。网络中的每个参与者都会保留分类帐的副本，并且每次创建新块时，都会将其广播给将其添加到分类帐本地副本的所有参与者。

区块链技术引起了大量研究人员的兴趣。最近研究表明，自2014年以来Scopus搜索关键词“区块链”发现了近600篇文章。这是[16,17,18]中提出的结构化文献综述过程的起点。 [2]中提供了这些研究人员提出的各种区块链架构的分类法以及每种架构的优点和局限性。首先，这些信任体系结构可以分为三个主要维度：（1）集中式与分布式; （2）私人/许可与公开/开放; （3）链上与脱链数据存储。

虽然主要是为分布式架构而设计，但区块链技术可以在集中式架构上实现。分布式架构通常采用点对点通信模型[19,20,21]。集中式，基于云的体系结构避免了与分布式体系结构相关的安全性和隐私性挑战，但也忽略了分布式体系结构的预期弹性，分布式治理，可伸缩性和可承受性。 IBM（国际商业机器公司）[22]提供了一个集中的，许可的区块链端到端SC管理系统。 Blockfreight [23]是用于SC容器跟踪的公共分布式区块链解决方案。

区块链分类帐可以是私有（允许）或公共（开放）。私有分类账倾向于通过集中式架构实现，而公共分类账倾向于通过分布式架构实现。除了上述两个例子[22,23]之外，文献中还提出了其他几种私有和公共区块链SC解决方案。实际上，对Scopus的上述搜索进行了改进，附加关键字“供应链”重新调整了大约70篇文章。例如，[24]中的分类账是公开的，并且从中小企业的角度支持SC需求规划中的信息共享。 [25]中提出的分类账是私人的。它支持B2B交易，并促进直接的制造商 - 客户交易和支付服务。通常，区块链技术的SC应用包括原产地证明和可追溯性[24,26]，库存和需求水平共享[25]以及药品[27]和食品[28]的法规执行。

共享敏感信息时，隐私尤为重要。例如，一些公司可能不愿意向竞争对手透露其生产能力[25]。在卫生部门，医疗记录的共享受到严格的隐私规则的约束。私有分类帐架构的另一种方法包括使用离线数据存储而不是链上数据存储。例如，在[29]中，提出了一种区块链分类账，用于共享患者的医疗记录。医疗记录与分类帐分开安全地存储在云上。然后，访问请求将发布到公共分类帐，共识节点负责从此公共分类帐中提取待处理请求，验证这些请求的有效性并将其发布到私有分类帐以实现可跟踪性。

使用完全公共或完全私有的分类帐架构进行信息交换可能无法满足各种应用程序（包括SC应用程序）的要求。需要一种基于协调使用两种类型分类帐的解决方案。敏感数据可以存储在私人分类帐中，而需要高信任级别的数据可以存储在公共分类帐中。这两种类型的分类账可以设计为限制每个利益相关者可以访问的信息，而不依赖于中央治理。建议的框架提倡这种方法，可以在当前的SC物理分发应用之外使用。一些可以从这种模式中受益的新兴应用包括金融，政府服务[30,31]，物联网（物联网）[26]和法规遵从[27]。

## Framework Design

拟议框架由一套动态和私人子分类账和一个中央公共分类账组成。 子分类账对贸易伙伴是私有的，并为每批货物创建子分类帐。 参与子分类帐的依据是参与执行相应采购订单的合作伙伴。 另一方面，公共分类账向所有人开放，并包含所有卡车运输货物的跟踪信息，以及代表每个私人活动的哈希值的记录。 在[32]中还提出了在不同分类账中分离数据记录及其哈希值，以便在以服务为中心的区块链应用程序中保护个人数据。 子分类帐和公共分类帐都是分布式的，每个参与节点都保留了感兴趣的分类帐的副本。 本节介绍用于两种类型分类帐的数据模型以及用于使这些分类帐中的信息保持最新的机制。

#### Architecture Overview

所提出的混合对等物理分发（HP3D）框架[33]的体系结构由一组子网络组成，每个子网络与特定的货物相关联。 子网络中的参与者是货物中涉及的贸易伙伴。 此外，子网络在下订单时创建，并在货物交付给客户时终止。

还有一个向所有合作伙伴以及第三方监视器开放的全球网络。 此全局网络是持久的，不会终止。 它用作与所有货件相关的事件的时间戳和记录证明。

HP3D中有四种类型的参与者：索引服务器，对等端，管理节点和外部监视器（图2）：
* 索引服务器是一个中心目录，用于维护网络中所有节点的地址。 它还为每个参与者分配一个唯一的ID。
* 对等方是可以在不同货件（例如，客户，供应商和承运商）中承担不同角色的节点。
* 管理节点是一个特殊的对等节点。 每个贸易伙伴都有一个管理节点，负责与组织内部的ERP进行通信。 该节点参与涉及相关合作伙伴的所有子网络，并维护与合作伙伴的货件相关的所有信息交换的永久记录。
* 第三方外部监视器负责验证货物的地理位置以及将此信息发布到公共分类帐。

所有节点都以事件的形式将信息发布到私人或公共分类账。 接下来将讨论拟议框架支持的不同类型的事件。

#### Events

拟议的框架支持三种类型的事件来记录货物的状态：

* 创世纪事件表明货物的开始（即发出采购订单）。这个事件类似于比特币中的起源事件[15]。它由客户的管理节点发起并向所有贸易伙伴广播。参与装运的每个合作伙伴都以文档的形式将此信息存储到其本地数据库中。创世纪事件的详细信息仅供贸易伙伴使用。但是，由genesis事件计算的哈希值也会由事件生成器（在本例中为客户）发布到公共分类帐。
* 保管事件是货物保管状态的记录。保管可以保留在货物的当前持有人处或显示从一个参与者到另一个参与者的转移（例如，从供应商转移到承运人的货物，由承运人交付给客户的货物）。除了创世纪事件之外，托管事件还形成以货件为中心的私人分类帐，该分类帐在给定货件的供应商，承运商和客户之间共享。与genesis事件类似，每个监护事件的哈希值也会被事件生成器计算并发布到公共分类帐。
* 监控事件表示货件的地理位置。当卡车在物理上靠近监视器并且在监视器和卡车之间执行信息交换以便记录该物理接近度时，该信息由外部监视器生成。监视事件由外部监视器发布到公共分类帐。

在公共分类帐的情况下，一组事件被链接以形成块，并且反过来，块被链接以形成分类帐。 将事件发布到私人和公共分类账如图3所示。

#### Data Structures

HP3D有三种数据结构，用于交换和存储事件和块。 这些是PrivateGCEvents，PublicEvents和Blocks。

PrivateGCEvents是用于在贸易伙伴之间交换的创世和监管事件的数据结构。 这个数据结构（图4）有三个字段，一个唯一的ID，一个事件的时间戳和一个包含创世纪事件或监护事件细节的子结构。 该子结构基于EDI-214标准。 EDI-214标准消息传统上表示为字符串，解析器用于将此消息从字符串表示转换为JSON表示，反之亦然。

PublicEvents（图5）是公共分类帐中使用的数据结构。 在genesis和custody事件的情况下，EventHash是记录事件的哈希值的字段。 此哈希值源自EDI-214格式的源事件。 贸易伙伴可以通过将公共分类账中的哈希值与私人分类账中的PrivateGCEvents数据结构计算出的哈希值进行比较来检查这两类事件的有效性。

监视事件使用MonitorData和EventHash数据结构。 MonitorData（图5）是一个子结构，包含监视器，卡车及其地理位置的信息。 EventHash是从MonitorData计算的。 PreEveHash和CurEveHash字段是用于链接事件和在公共分类帐中构建块的哈希值。 这两个值由每个节点在本地计算。

使用名为Blocks的数据结构将公共分类帐中的事件分组为块（图6），其中BlockID是块的唯一标识符。 由于块可能包含多个链接事件，因此Event字段是PublicEvents数组。 字段Timestamp对应于块的创建时间。 Nonce是为每个块计算的任意整数值。 它用于增加计算哈希值的复杂性。 PreBloHash具有上一个块中的CurBloHash的哈希值。

#### Blockchain

区块链分类帐可以被视为一个分布式数据库，其中包含分组为块的不断增加的事件列表[34]。如前所述，拟议的框架有两种类型的分类账：私人分类账和公共分类账（图3）。**私人分类帐包含创世纪事件和监护事件的详细信息。这些事件不被链接，从而限制了属于贸易伙伴的节点的计算要求。**此外，通过将私有分类帐中的源事件的哈希值与公共分类帐中的相应哈希值进行比较，可以轻松验证每个事件的有效性。因此，在提议的设计中，除了作为监测事件的永久记录之外，公共分类账还可作为创世和监护事件的参考和有效性证明。

网络中每个节点的本地数据库最多可包含四个集合：PrivateEvents，tempPublicEvent，Blocks和tempBlocks：
* PrivateEvents捕获创世纪和监护事件的细节。
* tempPublicEvent用于临时存储尚未成为公共分类帐中块的一部分的公共事件。
* 块用于链式块。最长的链被网络中的每个节点接受为记录的公共分类帐。
* 当同时接收到多个块时，或者当接收到的块的PreBloHash与节点的本地数据库中的最新块不匹配时，将使用tempBlocks。

每个监视器的本地数据库有两个集合：tempPublicEvent和Blocks。这些集合类似于上面讨论的贸易伙伴节点所使用的集合。监察员负责维护公共分类账。因此，它们不会生成创世纪事件或监护事件，也不需要维护PrivateEvents集合。

#### Validation

在所提出的系统中有两种信息验证。首先是事件的验证。第二个是块的验证。每次收到事件时都会检查事件。因此，当它们被链接或组合成公共分类帐中的块时，不需要再次检查它们。

创世纪事件表明新的货物。客户的管理节点是唯一可以生成创世纪事件的节点。由于此事件初始化新货件并建立订单ID，客户，供应商和承运人，因此无需验证genesis事件。

监管活动涉及两个不同公司的两名参与者。在共享之前，此事件使用参与者的私钥进行签名。通常，第一参与者的节点A首先对事件进行签名，然后第二参与者的节点B签署先前已由节点A签名的消息。随后，节点B发送双重签名的保管事件并被视为事件生成器。监管事件的详细信息由事件生成器广播给给定货件中的所有贸易伙伴。接收私有监管事件的节点通过使用节点A和节点B的公钥来检查消息。这种双重签名机制提高了私人分类账的安全性。如果事件被接受，则接收方节点将保管事件保存到其本地数据库中。该节点还计算并存储事件的公共版本，该事件的公共版本包含私有事件的哈希值在其公共分类帐的本地副本中。公共版本和保管事件的私有版本共享相同的EventID。事件生成器还负责与非贸易伙伴共享事件的公共版本。

监视事件由外部监视器生成。除了truckID和地理位置之外，外部监视器没有关于货物的任何信息。监控事件中的信息通过众包验证，因为预计多个监控器将报告单个卡车的地理位置。

第二种类型的验证是关于块的。在所提出的系统中，任何节点都可以提出候选块。为了限制节点可以提出的建议块的数量，节点需要找到满足给定格式的散列值的随机数。例如，散列值可以包括多个前导零，使得计算块的散列值的过程在计算上是昂贵的。在收到建议的块之后，其他节点验证块中的事件。只有当nonce满足并且所有公共事件在EventHash字段中的值与存储在其本地数据库中的值相同时，它们才接受该块。 

#### Processes

三个主要流程用于管理事件和块：
* 私人活动流程支持在货件中的贸易伙伴之间共享私人活动。
* 公共事件流程允许交换和公共事件发布到公共分类帐。
* 构建块过程将多个事件组合到一个块中，并验证公共分类帐中的每个块。

私有事件过程的工作流程如图7所示。此过程处理两个案例：创世纪事件和监护事件。 在第一种情况下，客户的管理节点通过从公司的ERP中提取数据来生成创世纪事件。 例如，图7中的节点A和节点B分别表示管理节点和常规节点。 一旦从ERP接收到消息，节点A就为该事件生成唯一的ID。 然后，此管理节点将该事件广播给其他合作伙伴。

在第二种情况下，当基础消息由两个参与者签名时，常规节点触发保管事件。例如，当货物从供应商转移到承运人时，供应商的雇员用他的私钥签署保管事件以确认该事件。随后，承运人的雇员签署保管事件并将其发送给贸易伙伴。

在这两种情况下，该过程的下一步包括生成与此私有事件关联的公共事件。私有事件的哈希值由事件生成器计算，并且结果公共事件被发送到非交易节点。该过程通过让事件生成器将公共事件存储在其公共分类帐的本地副本中来结束。私人活动仅在贸易伙伴之间共享。因此，监视器永远不会收到私人事件。它将仅在私有事件生成器将其发布到公共分类帐时接收私有事件的哈希值。

#### Public Event Process

公共事件可以是两种类型之一（图8）。 第一种类型是通过上述过程生成的私人创世或监护事件的散列值。 第二种类型是监控事件。 网络中的任何参与者都能够发送或接收公共事件。 收到的公共事件被链接在一起形成公共分类账。

在监视事件的情况下，当监视器和卡车交换指示物理接近的消息时，创建数据。监视器为事件生成唯一ID。它还将计算事件的哈希值并将其存储在MonitorData数据结构的EventHash字段中。最后，监视器将事件广播给公共分类帐的参与者。

收到公共事件后，它将被插入tempPublicEvent集合并链接到集合中的上一个事件（即，上一个事件的CurEveHash被用作新事件的PreEveHash。）一旦事件的数量tempPublicEvent集合超出预设值，可以提出新的块。

由于每个节点可以以不同的顺序接收公共事件，因此事件的PreEveHash可能不同，这导致CurEveHash的不同值。但是，EventHash与接收事件的顺序无关。此外，它是一致的，因为它是由事件生成器计算的。接下来描述的Building Block Process负责接收块并检查每个EventHash的有效性。

#### Build Block Process

任何节点或监视器都可以提出一个块（图9）。通过按节点接收的顺序使用事件来构建块。如果找到nonce，则节点将其建议的块广播到其他节点。当其他节点接收候选块时，他们可以通过使用提供的随机数重新计算CurBloHash来检查块的有效性。然后，节点通过将其与本地数据库进行比较来检查块中的每个事件的EventHash值。如果结果不同，则将丢弃建议的块。如果确认了候选块，则将前一个块的CurBloHash字段与当前块的PreBloHash进行比较。如果这两个字段匹配，则块将存储并链接到本地​​数据库中。否则，候选块将保存在名为tempBlocks的临时集合中。收件人节点可能缺少一个块，或者公共分类帐可能有多个分支。解决这些分类帐冲突和分叉问题是未来工作的主题。

## Implementation and Discussion

提出的系统中有三种节点：在X86平台上运行的X86节点，在Android平台上运行的移动节点以及也在X86平台上运行但具有扩展功能的管理节点。这些节点可以参与私人分类帐，公共分类帐或两者。

X86节点和管理节点具有相同的体系结构，包括三层：表示层，中间层和数据层。监视器只有一个中间层和一个数据层。 X86节点应用程序的中间层使用Golang [35]和Mgo（Golang的MongoDB [36]驱动程序）实现。监视器可以从传感器接收信号，生成和广播公共事件并更新其本地数据库。除了能够处理来自表示层的传入用户请求以及生成私有事件并将其发送给其合作伙伴之外，X86节点和管理节点也具有这些功能。所有节点都可以构建块。分类帐存储在数据层中并由中间层管理。

为了演示公共分类账和私人分类账的功能，开发了一个由三个节点和一个监控器组成的测试环境。测试侧重于节点之间的交换。为清楚起见，省略了节点和索引服务器之间的交换。测试场景中的节点A是属于公司A的管理节点。节点B和C分别属于公司B和C.测试场景中考虑以下五个事件：

* 事件1：由节点A生成的生成事件。它是与订单1相关的事件，其中公司A和公司B正在参与。
* 事件2：节点B发送的保管事件。这是与订单2相关的事件，与公司B和公司C共享。
* 事件3：由外部监视器生成的监视事件。它由发送到网络中所有节点的公共事件组成。它表示订单2的地理位置更新。
* 事件4：由节点B生成的保管事件。这是与公司A和公司B参与的订单1相关的事件。
* 事件5：由外部监视器生成的监视事件。它由一个公共事件组成，该事件被发送到网络中的所有节点，并代表订单1的地理位置更新。

上述测试场景创建了两个子网。一个由节点A和节点B共享，用于订单1。另一个子网络由节点B和节点C共享，用于订单2。这些子网络对于贸易伙伴是私有的。还需要一个全球网络来支持组成公共分类账的公共事件的交换。

创建了一个模拟器来触发上面提到的五个事件。对于创世纪事件，模拟器模仿ERP，负责将创世纪事件信息发送到管理节点。对于监护事件，模拟器验证并签署事件。对于监视事件，模拟器充当传感器，将地理位置数据发送到外部监视器。此外，出于测试目的，块大小设置为4.因此，当tempPublicEvent集合中有四个公共事件时，这些事件将用于形成候选块。

模拟器用于触发事件1，事件1由节点A接收。后一节点为该创世事件分配唯一ID。此外，由于这是一个私有事件，因此节点A只会将此事件发送到节点B.然后，它会将事件插入到PrivateEvents集合中的本地数据库中。在这种情况下，节点A被视为事件生成器。因此，它还将计算EventHash并将其发布到公共分类帐。节点B从节点A接收详细的起源事件并将其保存到其本地数据库中。节点C和监视器接收相应的公共事件，并在链接和计算CurEveHash后将其插入到tempPublicEvent集合中。由于这是数据库中的第一个事件，因此PreEveHash字段具有与EventHash相同的哈希值。图10和图11分别显示了事件1之后的节点A中的PrivateEvents集合和tempPublicEvent集合。 PrivateEvents集合中有一个文档。此私有事件由节点A和B共享。因此，节点B在其PrivateEvents集合中也具有相同的文档。对于所有节点和监视器，已翻译的事件存储在tempPublicEvent中。鉴于这也是公共分类帐中的第一个事件，所有节点上的所有tempPublicEvent集合（图11）都是相同的。

然后，模拟器用于触发事件2。随后，节点B接收保管事件。 它为事件分配一个唯一的ID，并执行先前由节点A为事件1执行的相同步骤。节点A不参与事件2。因此，它不接收私有事件，并且节点A的私有分类帐保持不变（ 图10）。 但是，节点A接收相应的公共事件作为网络中的任何其他节点。 如图12所示。

在步骤3中，模拟器用于触发第三事件，这是监视事件。 监控事件是公共事件。 监视器为公共事件分配唯一ID并计算EventHash。 它将事件保存到其本地tempPublicEvent集合中，并将其发送到节点A，B和C。tempPublicEvent中上一个事件的CurEveHash值用作当前事件的PreEveHash。 收到公共事件3后，节点A的tempPublicEvent集合如图13所示。

事件4与事件1相同，除了事件由节点B发送。广播事件5与事件3完全相同。当接收到事件5时，包括监视器的所有节点开始构建新块。 它们分配一个唯一的ID，计算新块的随机数并将其链接到前一个块。 生成的块被视为候选块，直到被其他节点验证为止。 该块如图14所示。

## Conclusions

拟议的框架利用分布式数据库，区块链技术和混合对等通信模型，以便以伪实时方式向所有利益相关者提供独立验证的货物跟踪信息。通过组合的私有 - 公共分类帐架构，该解决方案考虑了贸易伙伴的隐私要求，同时为关键决策提供必要的SC可见性。仔细管理区块链应用程序中隐私和透明度之间的权衡对于该技术的广泛采用至关重要。实际上，完全基于公共分类账的解决方案可能对各行各业和公共部门都没有吸引力。同样，许可/私人分类帐限制了该技术的预期效用。本文提出的方法证明了将两种类型的分类账结合起来以实际解决供应链中的差距的潜力。有趣的是，虽然它不是预期的目标，但所提出的模型也可能能够在物理分配阶段记录给定组织的碳足迹。我们还认为，拟议的模型可以扩展到其他应用领域，特别是在食品和制药行业的法规遵从方面。

拟议的框架仅在实验室环境中进行有限规模的测试。当它部署在具有大量节点的网络中时，可能会出现一些挑战。其中一些挑战包括解决块碰撞和分叉问题。目前在该领域有限的研究[16]，需要进一步的研究来理解这些挑战在实践中的意义。

未来工作的其他领域包括了解公共分类帐提供的与监视器数量相关的信任级别。大量监视器将提高信任级别。但是，由于人在环(human in the loop)，这种方法可能无法扩展。潜在的解决方案可能涉及使用V2V（车辆到车辆）技术。这将取决于车辆原始设备制造商（原始设备制造商）采用所提出的方法，并将需要新的政策。

最后，由于大量货物及其不同性质（距离，负荷分担，转运），公共分类账可能会迅速增长。能够智能地修剪分类账以管理其大小是另一个开放的研究领域。可以考虑一组地理划分的公共分类账，其中包括从一个分类账到另一个分类账的合适的交接机制。